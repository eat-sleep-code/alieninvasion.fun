(()=>{var t=navigator.userAgent.toLowerCase(),e=!1,i=!0,a=300,s=a,h=45,o=!1,r=0,n=[3,7,15,21,28,35,70,99],d=[5,9,23,42,49,69,89],m=1;Game.playerHealth=a,Game.defaultPlayerHealth=s,Game.difficultyMultiplier=m,document.onkeydown=function(t){var e;window.event?e=window.event.keyCode:t&&(e=t.which),(t=t||window.event).preventDefault(),65==e&&t.ctrlKey&&t.shiftKey&&T.boost()};var l={ship:{sx:0,sy:0,w:37,h:42,frames:1},missile:{sx:0,sy:30,w:4,h:10,frames:1},enemy_purple:{sx:37,sy:0,w:42,h:43,frames:1},enemy_bee:{sx:79,sy:0,w:37,h:43,frames:1},enemy_ship:{sx:116,sy:0,w:42,h:43,frames:1},enemy_circle:{sx:158,sy:0,w:32,h:33,frames:1},explosion:{sx:0,sy:64,w:64,h:64,frames:12},enemy_missile:{sx:8,sy:42,w:4,h:20,frame:1},enemy_bee_final:{sx:215,sy:0,w:73,h:50,frames:1},enemy_straight_final:{sx:287,sy:0,w:73,h:65,frames:1},enemy_circle_final:{sx:360,sy:0,w:70,h:60,frames:1}},w=(Math.PI,Math.PI,function(){t.match(/android/)?Game.setBoard(0,new _(50,.6,100,!0)):(Game.setBoard(0,new _(20,.4,100,!0)),Game.setBoard(1,new _(50,.6,100)),Game.setBoard(2,new _(100,1,50))),$(window).width()<=576?Game.setBoard(3,new SplashScreen("images/splash-mobile.svg","","",S)):Game.setBoard(3,new SplashScreen("images/splash.svg","","",S))}),y=["ltr","circle","step","straight","wiggle"],p=["wiggleFinal","straightFinal","circleFinal"],c=[],f=0,u=0,v=0;h+=Math.round(h*(m/10));do{var G;0===f?G=0:(G=v+Math.floor(2001*Math.random()+1e3)*(1==Math.floor(2*Math.random())?1:-1))<=0&&(G=u),u=G;var g,x,b=G+Math.floor(2001*Math.random()+3e3);v=b,f>h-4?(g=900,x=p[Math.floor(Math.random()*p.length)]):(g=Math.floor(401*Math.random()+400),x=y[Math.floor(Math.random()*y.length)]);var M=$("#game").width(),B=Math.floor(Math.random()*(M-10+1)+10);c.push([G,b,g,x,{x:B}]),f++}while(f<h);var S=function(){setTimeout((function(){var t=new GameBoard;t.add(new T),t.add(new Level(c,F)),Game.playerHealth=s,d.includes(r)&&(Game.playerHealth=Game.playerHealth+100),n.includes(r)&&(o=!1),Game.setBoard(3,t),1==i&&(Game.setBoard(5,new GamePoints(0)),Game.setBoard(6,new GameHealth(0)))}),500)},F=function(){try{bossLevel=!1,audio.boss.pause(),audio.boss.currentTime=0}catch(t){}audio.win.play(),i=!1,m*=1.5,r+=1,Game.setBoard(3,new SplashScreen("images/win.svg","","",S)),$(document).keydown((function(t){32!=t.which&&37!=t.which&&39!=t.which||setTimeout((function(){try{t.preventDefault()}catch(t){}}),1500)}))},_=function(t,e,i,a,s){var h=document.createElement("canvas");h.width=Game.width,h.height=Game.height;var o=h.getContext("2d"),r=0;a&&(o.fillStyle="#000",o.fillRect(0,0,h.width,h.height)),o.fillStyle=s||"#FFF",o.globalAlpha=e;for(var n=0;n<i;n++)o.fillRect(Math.floor(Math.random()*h.width),Math.floor(Math.random()*h.height),2,2);this.draw=function(t){var e=Math.floor(r),i=h.height-e;e>0&&t.drawImage(h,0,i,h.width,e,0,0,h.width,e),i>0&&t.drawImage(h,0,0,h.width,i,0,e,h.width,i)},this.step=function(e){r+=e*t,r%=h.height}},T=function(){this.setup("ship",{vx:0,reloadTime:.25,maxVel:200}),this.reload=this.reloadTime,this.x=Game.width/2-this.w/2,this.y=Game.height-Game.playerOffset-this.h,this.step=function(t){Game.keys.left?this.vx=-this.maxVel:Game.keys.right?this.vx=this.maxVel:this.vx=0,this.x+=this.vx*t,this.x<0?this.x=0:this.x>Game.width-this.w&&(this.x=Game.width-this.w),this.reload-=t,Game.keys.fire&&this.reload<0&&(Game.keys.fire=!1,this.reload=this.reloadTime,audio.fire.play(),this.board.add(new H(this.x,this.y+this.h/2)),this.board.add(new H(this.x+this.w,this.y+this.h/2)))}};T.boost=function(){if(0==o)if(audio.power.play(),a=600,o=!0,Game.playerHealth=a,t.match(/android/)||Game.width<=576)Game.setBoard(0,new _(100,.6,100,!0,"#00A9E0"));else{Game.setBoard(0,new _(60,.4,100,!0)),Game.setBoard(1,new _(150,.6,100)),Game.setBoard(2,new _(300,.8,50,!1,"#00A9E0"));var e=setInterval((function(){a<s&&(Game.setBoard(0,new _(20,.4,100,!0)),Game.setBoard(1,new _(50,.6,100)),Game.setBoard(2,new _(150,.8,50,!1,"#FFFFFF")),clearInterval(e))}),3e3)}},T.prototype=new Sprite,T.prototype.type=1,T.prototype.hit=function(t){0==isNaN(t)&&(a-=t,audio.hit.play(),Game.playerHealth=a),a<=0&&function(){a=s;try{bossLevel=!1,audio.boss.pause(),audio.boss.currentTime=0,audio.start.pause(),audio.start.currentTime=0}catch(t){}audio.lose.play(),m=1,i=!0,r=0,Game.setBoard(3,new SplashScreen("images/loss.svg","","",S)),$(document).keydown((function(t){32!=t.which&&37!=t.which&&39!=t.which||setTimeout((function(){try{t.preventDefault()}catch(t){}}),1500)}))}()};var H=function(t,e){this.setup("missile",{vy:-700,damage:10}),this.x=t-this.w/2,this.y=e-this.h};H.prototype=new Sprite,H.prototype.type=2,H.prototype.step=function(t){this.y+=this.vy*t;var e=this.board.collide(this,4);e?(e.hit(this.damage),this.board.remove(this)):this.y<-this.h&&this.board.remove(this)};var k=function(t,e){this.merge(this.baseParameters),this.setup(t.sprite,t),this.merge(e)};(k.prototype=new Sprite).type=4,k.prototype.baseParameters={A:0,B:0,C:0,D:0,E:0,F:0,G:0,H:0,t:0,reloadTime:.75,reload:0},k.prototype.step=function(t){this.t+=t,this.vx=this.A+this.B*Math.sin(this.C*this.t+this.D),this.vy=this.E+this.F*Math.sin(this.G*this.t+this.H),this.x+=this.vx*t,this.y+=this.vy*t;var e=this.board.collide(this,1);e&&(e.hit(this.damage),this.board.remove(this)),Math.random()<.01&&this.reload<=0&&(this.reload=this.reloadTime,2==this.missiles?(this.board.add(new E(this.x+this.w-2,this.y+this.h)),this.board.add(new E(this.x+2,this.y+this.h))):this.board.add(new E(this.x+this.w/2,this.y+this.h))),this.reload-=t,(this.y>Game.height||this.x<-this.w||this.x>Game.width)&&this.board.remove(this)},k.prototype.hit=function(t){this.health-=t,this.health<=0&&this.board.remove(this)&&(Game.points+=this.points||100,this.board.add(new A(this.x+this.w/2,this.y+this.h/2)),audio.boom.play())};var E=function(t,e){this.setup("enemy_missile",{vy:200,damage:10}),this.x=t-this.w/2,this.y=e};E.prototype=new Sprite,E.prototype.type=8,E.prototype.step=function(t){this.y+=this.vy*t;var e=this.board.collide(this,1);e?(e.hit(this.damage),this.board.remove(this)):this.y>Game.height&&this.board.remove(this)};var A=function(t,e){this.setup("explosion",{frame:0}),this.x=t-this.w/2,this.y=e-this.h/2};function I(){if(0==e)try{audio.start.play(),e=!0,S()}catch(t){}}A.prototype=new Sprite,A.prototype.step=function(t){this.frame++,this.frame>=12&&this.board.remove(this)},$(document).ready((function(){$("#game").click((function(){I()}))})),document.addEventListener("touchend",I),window.addEventListener("load",(function(){Game.initialize("game",l,w)}))})();