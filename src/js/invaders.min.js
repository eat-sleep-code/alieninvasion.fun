new Audio("audio/boom.mp3"),new Audio("audio/boss.mp3"),new Audio("audio/fire.mp3"),new Audio("audio/hit.mp3"),new Audio("audio/lose.mp3"),new Audio("audio/power.mp3"),new Audio("audio/start.mp3"),new Audio("audio/win.mp3"),(()=>{var t="",e=!1;!function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var a=(new Date).getTime(),s=Math.max(0,16-(a-t)),h=window.setTimeout((function(){e(a+s)}),s);return t=a+s,h}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();const i=new function(){var t=[];this.initialize=function(t,e,i){this.canvas=document.getElementById(t);var s=$(this.canvas).width(),h=$(this.canvas).height();if(this.canvas.width=s,this.canvas.height=h,this.playerOffset=20,this.canvasMultiplier=1,this.setupMobile(),this.width=this.canvas.width,this.height=this.canvas.height,this.ctx=this.canvas.getContext&&this.canvas.getContext("2d"),!this.ctx)return alert("Please upgrade your browser!");this.setupInput(),this.loop(),this.mobile&&this.setBoard(4,new n),a.load(e,i)};var e={37:"left",39:"right",32:"fire"};this.keys={},this.setupInput=function(){window.addEventListener("keydown",(function(t){e[t.keyCode]&&(i.keys[e[t.keyCode]]=!0,t.preventDefault())}),!1),window.addEventListener("keyup",(function(t){e[t.keyCode]&&(i.keys[e[t.keyCode]]=!1,t.preventDefault())}),!1)};var s=(new Date).getTime(),h=1/30;this.loop=function(){var e=(new Date).getTime();requestAnimationFrame(i.loop);var a=(e-s)/1e3;a>h&&(a=h);for(var n=0,o=t.length;n<o;n++)t[n]&&(t[n].step(a),t[n].draw(i.ctx));s=e},this.setBoard=function(e,i){t[e]=i},this.setupMobile=function(){document.getElementById("container");var t=!!("ontouchstart"in window),e=window.innerWidth,i=window.innerHeight;if(t&&(this.mobile=!0),screen.width>=1280||!t)return!1;e>i&&(alert("Please rotate the device!"),e=window.innerWidth,i=window.innerHeight),this.canvas.style.width="100vw",this.canvas.style.height="100vh"}},a=new function(){return this.map={},this.load=function(t,e){this.map=t,this.image=new Image,this.image.onload=e,this.image.src="images/sprites.png"},this.draw=function(t,e,i,a,s){var h=this.map[e];s||(s=0),t.drawImage(this.image,h.sx+s*h.w,h.sy,h.w,h.h,Math.floor(i),Math.floor(a),h.w,h.h)},this},s=function(){};s.prototype.setup=function(t,e){this.sprite=t,this.merge(e),this.frame=this.frame||0,this.w=a.map[t].w,this.h=a.map[t].h},s.prototype.merge=function(t){if(t)for(var e in t)this[e]=t[e]},s.prototype.draw=function(t){a.draw(t,this.sprite,this.x,this.y,this.frame)},s.prototype.hit=function(t){this.board.remove(this)};const h=function(t,e){this.levelData=[];for(var i=0;i<t.length;i++)this.levelData.push(Object.create(t[i]));this.t=0,this.callback=e};h.prototype.step=function(t){var i=0,a=[],s=null;for(this.t+=1e3*t;(s=this.levelData[i])&&s[0]<this.t+2e3;){if(this.t>s[1])a.push(s);else if(s[0]<this.t){var h=enemies[s[3]],n=s[4];this.board.add(new Enemy(h,n)),s[0]+=s[2]}i++}for(var o=0,r=a.length;o<r;o++){var d=this.levelData.indexOf(a[o]);-1!=d&&this.levelData.splice(d,1)}if(0===this.levelData.length&&0===this.board.cnt[OBJECT_ENEMY]&&this.callback&&this.callback(),0==e)try{String(s[3]).includes("Final")&&(e=!0,audio.boss.play())}catch(t){}},h.prototype.draw=function(t){};const n=function(){var e=i.width/5,a=e-10;this.drawSquare=function(t,i,s,h,n){t.globalAlpha=n?.1:.5,t.fillStyle="#CCC",t.fillRect(i,s,a,a),t.fillStyle="#FFF",t.globalAlpha=1,t.font="bold "+3*e/4+"px 'Verdana'";var o=t.measureText(h);t.fillText(h,i+a/2-o.width/2,s+3*a/4+5)},this.draw=function(t){t.save();var a=i.height-e;this.drawSquare(t,10,a,"ᐊ",i.keys.left),this.drawSquare(t,e+10,a,"ᐅ",i.keys.right),this.drawSquare(t,4*e,a,"✹",i.keys.fire),t.restore()},this.step=function(t){},this.trackTouch=function(a){var s;a.preventDefault(),i.keys.left=!1,i.keys.right=!1;for(var h=0;h<a.targetTouches.length;h++)(s=a.targetTouches[h].pageX/i.canvasMultiplier-i.canvas.offsetLeft)<e&&(t=t.concat("l"),i.keys.left=!0),s>e&&s<2*e&&(t=t.concat("r"),i.keys.right=!0),t.includes("lllllllllllllllllrrrrrrrrrrrrrrrr")&&PlayerShip.boost();if("touchstart"==a.type||"touchend"==a.type)for(h=0;h<a.changedTouches.length;h++)(s=a.changedTouches[h].pageX/i.canvasMultiplier-i.canvas.offsetLeft)>4*e&&(t=t.concat("u"),i.keys.fire="touchstart"==a.type)},i.canvas.addEventListener("touchstart",this.trackTouch,!0),i.canvas.addEventListener("touchmove",this.trackTouch,!0),i.canvas.addEventListener("touchend",this.trackTouch,!0),i.canvas.addEventListener("dblclick",(function(t){t.preventDefault()}),!0),i.canvas.addEventListener("click",(function(t){t.preventDefault()}),!0),i.playerOffset=e+20}})(),(()=>{var t=navigator.userAgent.toLowerCase(),e=!1,i=!0,a=300,s=a,h=45,n=!1,o=0,r=[3,7,15,21,28,35,70,99],d=[5,9,23,42,49,69,89],l=1;Game.playerHealth=a,Game.defaultPlayerHealth=s,Game.difficultyMultiplier=l,document.onkeydown=function(t){var e;window.event?e=window.event.keyCode:t&&(e=t.which),(t=t||window.event).preventDefault(),65==e&&t.ctrlKey&&t.shiftKey&&B.boost()};var c={ship:{sx:0,sy:0,w:37,h:42,frames:1},missile:{sx:0,sy:30,w:4,h:10,frames:1},enemy_purple:{sx:37,sy:0,w:42,h:43,frames:1},enemy_bee:{sx:79,sy:0,w:37,h:43,frames:1},enemy_ship:{sx:116,sy:0,w:42,h:43,frames:1},enemy_circle:{sx:158,sy:0,w:32,h:33,frames:1},explosion:{sx:0,sy:64,w:64,h:64,frames:12},enemy_missile:{sx:8,sy:42,w:4,h:20,frame:1},enemy_bee_final:{sx:215,sy:0,w:73,h:50,frames:1},enemy_straight_final:{sx:287,sy:0,w:73,h:65,frames:1},enemy_circle_final:{sx:360,sy:0,w:70,h:60,frames:1}},m=(Math.PI,Math.PI,function(){t.match(/android/)?Game.setBoard(0,new T(50,.6,100,!0)):(Game.setBoard(0,new T(20,.4,100,!0)),Game.setBoard(1,new T(50,.6,100)),Game.setBoard(2,new T(100,1,50))),$(window).width()<=576?Game.setBoard(3,new SplashScreen("images/splash-mobile.svg","","",F)):Game.setBoard(3,new SplashScreen("images/splash.svg","","",F))}),u=["ltr","circle","step","straight","wiggle"],w=["wiggleFinal","straightFinal","circleFinal"],f=[],p=0,y=0,v=0;h+=Math.round(h*(l/10));do{var g;0===p?g=0:(g=v+Math.floor(2001*Math.random()+1e3)*(1==Math.floor(2*Math.random())?1:-1))<=0&&(g=y),y=g;var x,b,G=g+Math.floor(2001*Math.random()+3e3);v=G,p>h-4?(x=900,b=w[Math.floor(Math.random()*w.length)]):(x=Math.floor(401*Math.random()+400),b=u[Math.floor(Math.random()*u.length)]);var k=$("#game").width(),M=Math.floor(Math.random()*(k-10+1)+10);f.push([g,G,x,b,{x:M}]),p++}while(p<h);var F=function(){setTimeout((function(){var t=new GameBoard;t.add(new B),t.add(new Level(f,A)),Game.playerHealth=s,d.includes(o)&&(Game.playerHealth=Game.playerHealth+100),r.includes(o)&&(n=!1),Game.setBoard(3,t),1==i&&(Game.setBoard(5,new GamePoints(0)),Game.setBoard(6,new GameHealth(0)))}),500)},A=function(){try{bossLevel=!1,audio.boss.pause(),audio.boss.currentTime=0}catch(t){}audio.win.play(),i=!1,l*=1.5,o+=1,Game.setBoard(3,new SplashScreen("images/win.svg","","",F)),$(document).keydown((function(t){32!=t.which&&37!=t.which&&39!=t.which||setTimeout((function(){try{t.preventDefault()}catch(t){}}),1500)}))},T=function(t,e,i,a,s){var h=document.createElement("canvas");h.width=Game.width,h.height=Game.height;var n=h.getContext("2d"),o=0;a&&(n.fillStyle="#000",n.fillRect(0,0,h.width,h.height)),n.fillStyle=s||"#FFF",n.globalAlpha=e;for(var r=0;r<i;r++)n.fillRect(Math.floor(Math.random()*h.width),Math.floor(Math.random()*h.height),2,2);this.draw=function(t){var e=Math.floor(o),i=h.height-e;e>0&&t.drawImage(h,0,i,h.width,e,0,0,h.width,e),i>0&&t.drawImage(h,0,0,h.width,i,0,e,h.width,i)},this.step=function(e){o+=e*t,o%=h.height}},B=function(){this.setup("ship",{vx:0,reloadTime:.25,maxVel:200}),this.reload=this.reloadTime,this.x=Game.width/2-this.w/2,this.y=Game.height-Game.playerOffset-this.h,this.step=function(t){Game.keys.left?this.vx=-this.maxVel:Game.keys.right?this.vx=this.maxVel:this.vx=0,this.x+=this.vx*t,this.x<0?this.x=0:this.x>Game.width-this.w&&(this.x=Game.width-this.w),this.reload-=t,Game.keys.fire&&this.reload<0&&(Game.keys.fire=!1,this.reload=this.reloadTime,audio.fire.play(),this.board.add(new S(this.x,this.y+this.h/2)),this.board.add(new S(this.x+this.w,this.y+this.h/2)))}};B.boost=function(){if(0==n)if(audio.power.play(),a=600,n=!0,Game.playerHealth=a,t.match(/android/)||Game.width<=576)Game.setBoard(0,new T(100,.6,100,!0,"#00A9E0"));else{Game.setBoard(0,new T(60,.4,100,!0)),Game.setBoard(1,new T(150,.6,100)),Game.setBoard(2,new T(300,.8,50,!1,"#00A9E0"));var e=setInterval((function(){a<s&&(Game.setBoard(0,new T(20,.4,100,!0)),Game.setBoard(1,new T(50,.6,100)),Game.setBoard(2,new T(150,.8,50,!1,"#FFFFFF")),clearInterval(e))}),3e3)}},B.prototype=new Sprite,B.prototype.type=1,B.prototype.hit=function(t){0==isNaN(t)&&(a-=t,audio.hit.play(),Game.playerHealth=a),a<=0&&function(){a=s;try{bossLevel=!1,audio.boss.pause(),audio.boss.currentTime=0,audio.start.pause(),audio.start.currentTime=0}catch(t){}audio.lose.play(),l=1,i=!0,o=0,Game.setBoard(3,new SplashScreen("images/loss.svg","","",F)),$(document).keydown((function(t){32!=t.which&&37!=t.which&&39!=t.which||setTimeout((function(){try{t.preventDefault()}catch(t){}}),1500)}))}()};var S=function(t,e){this.setup("missile",{vy:-700,damage:10}),this.x=t-this.w/2,this.y=e-this.h};S.prototype=new Sprite,S.prototype.type=2,S.prototype.step=function(t){this.y+=this.vy*t;var e=this.board.collide(this,4);e?(e.hit(this.damage),this.board.remove(this)):this.y<-this.h&&this.board.remove(this)};var D=function(t,e){this.merge(this.baseParameters),this.setup(t.sprite,t),this.merge(e)};(D.prototype=new Sprite).type=4,D.prototype.baseParameters={A:0,B:0,C:0,D:0,E:0,F:0,G:0,H:0,t:0,reloadTime:.75,reload:0},D.prototype.step=function(t){this.t+=t,this.vx=this.A+this.B*Math.sin(this.C*this.t+this.D),this.vy=this.E+this.F*Math.sin(this.G*this.t+this.H),this.x+=this.vx*t,this.y+=this.vy*t;var e=this.board.collide(this,1);e&&(e.hit(this.damage),this.board.remove(this)),Math.random()<.01&&this.reload<=0&&(this.reload=this.reloadTime,2==this.missiles?(this.board.add(new E(this.x+this.w-2,this.y+this.h)),this.board.add(new E(this.x+2,this.y+this.h))):this.board.add(new E(this.x+this.w/2,this.y+this.h))),this.reload-=t,(this.y>Game.height||this.x<-this.w||this.x>Game.width)&&this.board.remove(this)},D.prototype.hit=function(t){this.health-=t,this.health<=0&&this.board.remove(this)&&(Game.points+=this.points||100,this.board.add(new L(this.x+this.w/2,this.y+this.h/2)),audio.boom.play())};var E=function(t,e){this.setup("enemy_missile",{vy:200,damage:10}),this.x=t-this.w/2,this.y=e};E.prototype=new Sprite,E.prototype.type=8,E.prototype.step=function(t){this.y+=this.vy*t;var e=this.board.collide(this,1);e?(e.hit(this.damage),this.board.remove(this)):this.y>Game.height&&this.board.remove(this)};var L=function(t,e){this.setup("explosion",{frame:0}),this.x=t-this.w/2,this.y=e-this.h/2};function C(){if(0==e)try{audio.start.play(),e=!0,F()}catch(t){}}L.prototype=new Sprite,L.prototype.step=function(t){this.frame++,this.frame>=12&&this.board.remove(this)},$(document).ready((function(){$("#game").click((function(){C()}))})),document.addEventListener("touchend",C),window.addEventListener("load",(function(){Game.initialize("game",c,m)}))})(),(()=>{function t(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],t("js",new Date),t("config","UA-136336-17")})();